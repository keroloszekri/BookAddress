<div class="form-group row">
    <div class="col-xs-6 ">
        <a class="btn btn-danger" style="cursor: pointer ; width: 100%;" (click)="exportexcel()">Download Xsls File </a>
    </div>
    <div class="col-xs-6">
        <div class="input-group">
            <input name="search" [(ngModel)]="searchText" autocomplete="off" class="form-control"
                placeholder="Search...">
            <span class="input-group-btn">
                <button type="submit" name="search" id="search-btn" class="btn btn-flat"><i class="fa fa-search"></i>
                </button>
            </span>
        </div>
    </div>
</div>

<table class="table table-striped table-danger" id="excel-table">
    <thead>
        <tr>
            <th>PIC</th>
            <th>Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Date</th>
            <th></th>

        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let item of sortedArray | filter:searchText ">
            <td><img src="{{URL}}/Content/{{item.Img}}" alt="{{item.Name}} image" style="width:50px; height: 50px;">
            </td>
            <td>{{item.Name}}</td>
            <td>{{item.Email}}</td>
            <td>{{item.Phone}}</td>
            <td>{{item.Date}}</td>
            <td>
                <a (click)="GitOneProduct(item.ID)" href="#EditModal" class="Edit" data-toggle="modal">Edit</a> |
                <a (click)="GitOneProduct(item.ID)" href="#DeleteModal" class="Edit" data-toggle="modal">Delete</a>
            </td>
        </tr>
        <tr>
    </tbody>
</table>

<!-- edit Model -->
<div class="modal fade" id="EditModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Editing Department</h4>
            </div>
            <div class="modal-body">
                <form class="form-group" [formGroup]="EditdeForm">
                    <div class="form-group">
                        <label for="">Name</label>
                        <input type="text" [(ngModel)]="this.EditPerson.Name" class="form-control"
                            formControlName="Name" name="Name" id="Name"
                            [class.is-valid]="EditdeForm.controls['Name'].valid "
                            [class.is-invalid]="EditdeForm.controls['Name'].invalid && EditdeForm.controls['Name'].touched">
                    </div>
                    <div [hidden]="EditdeForm.controls['Name'].valid || EditdeForm.controls['Name'].untouched "
                        class="alert alert-danger">
                        Name is required
                    </div>


                    <div class="form-group">
                        <label for="">Job</label>
                        <select [(ngModel)]="this.EditPerson.Job" formControlName="Job" class="form-control"
                            [class.is-valid]="EditdeForm.controls['Job'].valid "
                            [class.is-invalid]="EditdeForm.controls['Job'].invalid && EditdeForm.controls['Job'].touched">
                            <option *ngFor="let item of ListJob" [value]="item.ID"
                                [selected]="item.Name==this.EditPerson.Job">{{item.Name}}</option>
                        </select>
                    </div>
                    <div [hidden]="EditdeForm.controls['Job'].valid || EditdeForm.controls['Job'].untouched "
                        class="alert alert-danger">
                        Job is required
                    </div>


                    <div class="form-group">
                        <label for="">Department</label>
                        <select [(ngModel)]="this.EditPerson.Department" formControlName="Department"
                            class="form-control" [class.is-valid]="EditdeForm.controls['Department'].valid "
                            [class.is-invalid]="EditdeForm.controls['Department'].invalid && EditdeForm.controls['Department'].touched">
                            <option *ngFor="let item of ListDepartment" [value]="item.ID"
                                [selected]="this.EditPerson.Department==item.Name">{{item.Name}}</option>
                        </select>
                    </div>
                    <div [hidden]="EditdeForm.controls['Department'].valid || EditdeForm.controls['Department'].untouched "
                        class="alert alert-danger">
                        Department is required
                    </div>


                    <div class="form-group">
                        <label for="">Phone</label>
                        <input type="text" [(ngModel)]="this.EditPerson.Phone" class="form-control"
                            formControlName="Phone" name="Phone" id="Phone"
                            [class.is-valid]="EditdeForm.controls['Phone'].valid "
                            [class.is-invalid]="EditdeForm.controls['Phone'].invalid && EditdeForm.controls['Phone'].touched">
                    </div>
                    <div [hidden]="EditdeForm.controls['Phone'].valid || EditdeForm.controls['Phone'].untouched "
                        class="alert alert-danger">
                        Phone is required
                    </div>


                    <div class="form-group">
                        <label for="">Date</label>
                        <input type="date" [(ngModel)]="this.EditPerson.Date" class="form-control"
                            formControlName="Date" name="Date" id="Date"
                            [class.is-valid]="EditdeForm.controls['Date'].valid "
                            [class.is-invalid]="EditdeForm.controls['Date'].invalid && EditdeForm.controls['Date'].touched">
                    </div>
                    <div [hidden]="EditdeForm.controls['Date'].valid || EditdeForm.controls['Date'].untouched "
                        class="alert alert-danger">
                        Date is required
                    </div>


                    <div class="form-group">
                        <label for="">Address</label>
                        <input type="text" [(ngModel)]="this.EditPerson.Address" class="form-control"
                            formControlName="Address" name="Address" id="Address"
                            [class.is-valid]="EditdeForm.controls['Address'].valid "
                            [class.is-invalid]="EditdeForm.controls['Address'].invalid && EditdeForm.controls['Address'].touched">
                    </div>
                    <div [hidden]="EditdeForm.controls['Address'].valid || EditdeForm.controls['Address'].untouched "
                        class="alert alert-danger">
                        Address is required
                    </div>


                    <div class="form-group">
                        <label for="">Email Space</label>
                        <input type="email" [(ngModel)]="this.EditPerson.Email" class="form-control"
                            formControlName="Email" name="Email" id="Email"
                            [class.is-valid]="EditdeForm.controls['Email'].valid "
                            [class.is-invalid]="EditdeForm.controls['Email'].invalid && EditdeForm.controls['Email'].touched">
                    </div>
                    <div [hidden]="EditdeForm.controls['Email'].valid || EditdeForm.controls['Email'].untouched "
                        class="alert alert-danger">
                        Email is required
                    </div>


                    <div class="form-group">
                        <label for="">Age</label>
                        <input type="number" [(ngModel)]="this.EditPerson.Age" class="form-control"
                            formControlName="Age" name="Age" id="Age"
                            [class.is-valid]="EditdeForm.controls['Age'].valid "
                            [class.is-invalid]="EditdeForm.controls['Age'].invalid && EditdeForm.controls['Age'].touched">
                    </div>
                    <div [hidden]="EditdeForm.controls['Age'].valid || EditdeForm.controls['Age'].untouched "
                        class="alert alert-danger">
                        Age is required
                    </div>

                    <div class="form-group">
                        <label for="">Img</label>
                        <input type="file" (change)="onFileSelected($event)" class="form-control" formControlName="Img"
                            name="Img" id="Img" [class.is-valid]="EditdeForm.controls['Img'].valid "
                            [class.is-invalid]="EditdeForm.controls['Img'].invalid && EditdeForm.controls['Img'].touched">
                    </div>
                    <div [hidden]="EditdeForm.controls['Img'].valid || EditdeForm.controls['Img'].untouched "
                        class="alert alert-danger">
                        Img is required
                    </div>


                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" style="width: 100%;"
                    data-dismiss="modal">Close</button><br>
                <button type="submit" (click)="EditProduct()" data-dismiss="modal" class="btn btn-default"
                    style="width: 100%;" [disabled]="EditdeForm.invalid">Edit</button>

            </div>
        </div>


    </div>
</div>

<!-- delete Model -->
<div class="modal fade" id="DeleteModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Delete Department</h4>
            </div>
            <div class="modal-body">
                <h3>Are You sure from Delete</h3>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" style="width: 100%;" data-dismiss="modal">No,
                    Close</button><br>
                <button type="submit" (click)="DeleteProduct()" data-dismiss="modal" class="btn btn-default"
                    style="width: 100%;">Delete</button>

            </div>
        </div>


    </div>
</div>